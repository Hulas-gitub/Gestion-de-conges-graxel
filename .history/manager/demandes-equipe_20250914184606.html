<!DOCTYPE html>
<html lang="fr" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graxel Tech - Demandes d'équipe</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
    <script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Vos fichiers existants -->
    <script src="assets/javascript/config.js"></script>
    <script src="assets/javascript/animate.js"></script>
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- Bibliothèques pour les fonctionnalités avancées -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.0.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.2.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* Styles supplémentaires pour les nouvelles fonctionnalités */
        .demand-table { width: 100%; border-collapse: collapse; }
        .demand-table th { background: #f9fafb; font-weight: 600; padding: 12px 16px; text-align: left; }
        .demand-table td { padding: 12px 16px; border-bottom: 1px solid #e5e7eb; }
        .demand-table tr:hover { background: rgba(59, 130, 246, 0.05); }
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            text-align: center;
        }
        .status-pending { background: #fef3c7; color: #d97706; }
        .status-approved { background: #dcfce7; color: #166534; }
        .status-rejected { background: #fee2e2; color: #dc2626; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1000; }
        .modal-content { background: white; margin: 10% auto; padding: 24px; border-radius: 12px; width: 90%; max-width: 500px; }
        .dark .modal-content { background: #1f2937; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .calendar-day {
            padding: 8px;
            text-align: center;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .calendar-day:hover { background: rgba(59, 130, 246, 0.1); }
        .calendar-day.absent { background: rgba(255, 0, 0, 0.1); color: #ef4444; }
        .calendar-day.today { background: #3b82f6; color: white; }
        .calendar-day.selected { background: #10b981; color: white; }
        .filter-section { background: rgba(255, 255, 255, 0.5); padding: 16px; border-radius: 12px; margin-bottom: 20px; }
    </style>
</head>
<body class="h-full bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 font-poppins transition-all duration-500">
    <!-- Background Pattern -->
    <div class="fixed inset-0 bg-pattern opacity-5 pointer-events-none"></div>

    <!-- Token de notification -->
    <div id="notification-token" class="notification-token glass-effect text-white px-6 py-3 rounded-2xl shadow-2xl">
        <div class="flex items-center space-x-3">
            <div class="w-3 h-3 bg-white rounded-full animate-pulse"></div>
            <span id="token-text" class="text-sm font-medium">Demandes d'équipe</span>
            <i id="token-icon" class="fas fa-check text-sm"></i>
        </div>
    </div>

    <!-- Sidebar Overlay (Mobile) -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden sidebar-overlay hidden"></div>

    <div class="flex h-full">
        <!-- Sidebar -->
        <div id="sidebar" class="fixed md:relative w-80 md:w-72 bg-white dark:bg-gray-800 shadow-2xl border-r border-gray-200 dark:border-gray-700 z-50 md:z-auto sidebar-mobile animate-slide-right transition-all duration-300 -translate-x-full md:translate-x-0">
            <div class="p-6 h-full flex flex-col">
                <!-- Close button (Mobile) -->
                <button id="close-sidebar" class="absolute top-4 right-4 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 md:hidden">
                    <i class="fas fa-times text-gray-600 dark:text-gray-400"></i>
                </button>

                <!-- Logo -->
                <div class="flex items-center space-x-4 mb-10">
                    <div class="w-30 h-30 rounded-2xl flex items-center justify-center shadow-lg">
                        <img src="assets/images/logo.png" alt="Logo Graxel Tech" class="w-full h-full object-contain rounded-2xl" />
                    </div>
                </div>

                <!-- Navigation -->
                <nav class="space-y-3 flex-1">
                    <a href="tableau-de-bord.html" class="nav-item flex items-center space-x-4 px-4 py-4 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl hover-lift transition-all duration-300 click-scale">
                        <i class="fas fa-chart-pie w-5 h-5 text-lg"></i>
                        <span>Tableau de bord</span>
                    </a>
                    <a href="demandes-equipe.html" class="nav-item flex items-center space-x-4 px-4 py-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover-lift transition-all duration-300 click-scale shadow-lg">
                        <i class="fas fa-users w-5 h-5 text-lg"></i>
                        <span>Demandes d'équipe</span>
                    </a>
                    <a href="calendrier-equipe.html" class="nav-item flex items-center space-x-4 px-4 py-4 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl hover-lift transition-all duration-300 click-scale">
                        <i class="fas fa-calendar-alt w-5 h-5 text-lg"></i>
                        <span>Calendrier équipe</span>
                    </a>
                    <a href="alertes.html" class="nav-item flex items-center space-x-4 px-4 py-4 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl hover-lift transition-all duration-300 click-scale">
                        <i class="fas fa-exclamation-triangle w-5 h-5 text-lg"></i>
                        <span>Alertes</span>
                    </a>
                    <a href="profile.html" class="nav-item flex items-center space-x-4 px-4 py-4 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl hover-lift transition-all duration-300 click-scale">
                        <i class="fas fa-user w-5 h-5 text-lg"></i>
                        <span>Mon profil</span>
                    </a>
                    <a href="mot-de-passe.html" class="nav-item flex items-center space-x-4 px-4 py-4 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl hover-lift transition-all duration-300 click-scale">
                        <i class="fas fa-key w-5 h-5 text-lg"></i>
                        <span>Mot de passe</span>
                    </a>
                </nav>

                <!-- User Profile -->
                <div class="border-t border-gray-200 dark:border-gray-700 pt-6 mt-6">
                    <div class="flex items-center space-x-4 mb-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full flex items-center justify-center text-white font-bold text-lg animate-float">
                            JM
                        </div>
                        <div class="flex-1">
                            <p class="font-semibold text-gray-900 dark:text-white">Jean Martin</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Chef de Département Finance</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <a href="#" class="flex items-center space-x-3 text-red-600 hover:text-red-700 dark:text-red-400 text-sm hover-lift transition-all duration-200 p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20">
                            <i class="fas fa-sign-out-alt w-4 h-4"></i>
                            <span>Déconnexion</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 overflow-auto custom-scrollbar">
            <!-- Header -->
            <div class="bg-white/70 dark:bg-gray-800/70 backdrop-blur-lg shadow-lg border-b border-gray-200/50 dark:border-gray-700/50 px-4 md:px-8 py-6 animate-fade-in sticky top-0 z-30">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <button id="toggle-sidebar" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 md:hidden">
                            <i class="fas fa-bars text-gray-600 dark:text-gray-400"></i>
                        </button>
                        <div>
                            <h1 class="text-2xl md:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">Demandes d'équipe</h1>
                            <p class="text-gray-600 dark:text-gray-400 mt-1">
                                <i class="fas fa-users mr-2"></i>
                                <span id="current-date"></span>
                            </p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button id="theme-toggle" class="p-3 bg-gray-100 dark:bg-gray-700 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 transition-all duration-300 click-scale hover-lift">
                            <i class="fas fa-moon dark:hidden text-gray-600 text-lg"></i>
                            <i class="fas fa-sun hidden dark:block text-yellow-400 text-lg"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Page Content -->
            <div class="p-4 md:p-8 space-y-8">
                <!-- Filtres et recherche -->
                <div class="filter-section bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 p-6 animate-slide-up">
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-6">Filtres et recherche</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <!-- Recherche par nom/matricule -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Rechercher</label>
                            <div class="relative">
                                <input type="text" id="search-input" placeholder="Nom ou matricule..."
                                       class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                                <i class="fas fa-search absolute right-3 top-2.5 text-gray-400"></i>
                            </div>
                        </div>
                        <!-- Filtre par statut -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Statut</label>
                            <select id="status-filter" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                                <option value="all">Tous</option>
                                <option value="pending">En attente</option>
                                <option value="approved">Validé</option>
                                <option value="rejected">Refusé</option>
                            </select>
                        </div>
                        <!-- Filtre par type de congé -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Type de congé</label>
                            <select id="type-filter" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                                <option value="all">Tous</option>
                                <option value="annual">Congés payés</option>
                                <option value="sick">Maladie</option>
                                <option value="rtt">RTT</option>
                                <option value="exceptional">Exceptionnel</option>
                                <option value="maternity">Maternité</option>
                            </select>
                        </div>
                        <!-- Filtre par employé -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Employé</label>
                            <select id="employee-filter" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                                <option value="all">Tous</option>
                                <option value="Jean Martin">Jean Martin</option>
                                <option value="Marie Dupont">Marie Dupont</option>
                                <option value="Pierre Leroux">Pierre Leroux</option>
                                <option value="Sophie Moreau">Sophie Moreau</option>
                            </select>
                        </div>
                    </div>
                    <!-- Filtre par période -->
                    <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Période</label>
                            <select id="period-filter" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                                <option value="month">Ce mois</option>
                                <option value="week">Cette semaine</option>
                                <option value="custom">Personnalisée</option>
                            </select>
                        </div>
                        <div id="custom-date-range" class="hidden md:col-span-2 grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Du</label>
                                <input type="date" id="start-date" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Au</label>
                                <input type="date" id="end-date" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white">
                            </div>
                        </div>
                    </div>
                    <!-- Bouton de réinitialisation -->
                    <div class="mt-4 flex justify-end">
                        <button id="reset-filters" class="px-6 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                            Réinitialiser
                        </button>
                    </div>
                </div>

                <!-- Statistiques rapides -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 p-6 animate-slide-up">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center">
                                <i class="fas fa-hourglass-half text-blue-600 dark:text-blue-400 text-xl"></i>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Demandes en attente</p>
                                <p class="text-2xl font-bold text-gray-900 dark:text-white mt-1" id="pending-count">12</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 p-6 animate-slide-up">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-xl flex items-center justify-center">
                                <i class="fas fa-check-circle text-green-600 dark:text-green-400 text-xl"></i>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Congés validés ce mois</p>
                                <p class="text-2xl font-bold text-gray-900 dark:text-white mt-1" id="approved-count">47</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 p-6 animate-slide-up">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900/30 rounded-xl flex items-center justify-center">
                                <i class="fas fa-user-clock text-orange-600 dark:text-orange-400 text-xl"></i>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Employé le plus absent</p>
                                <p class="text-2xl font-bold text-gray-900 dark:text-white mt-1" id="top-absent-employee">Jean Martin</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400 mt-1" id="top-absent-days">12 jours</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tableau des demandes -->
                <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 p-6 animate-slide-up">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white">Liste des demandes</h3>
                        <button id="export-pdf" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2">
                            <i class="fas fa-file-pdf"></i>
                            <span>Exporter en PDF</span>
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="demand-table w-full">
                            <thead>
                                <tr>
                                    <th>Employé</th>
                                    <th>Type</th>
                                    <th>Dates</th>
                                    <th>Statut</th>
                                    <th>Commentaire</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="demands-table-body">
                                <!-- Les lignes seront générées dynamiquement -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Calendrier des absences -->
                <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 p-6 animate-slide-up">
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-6">Calendrier des absences (Septembre 2025)</h3>
                    <div class="calendar-grid text-xs">
                        <!-- En-têtes des jours -->
                        <div class="calendar-day font-bold text-gray-600 dark:text-gray-300">Lun</div>
                        <div class="calendar-day font-bold text-gray-600 dark:text-gray-300">Mar</div>
                        <div class="calendar-day font-bold text-gray-600 dark:text-gray-300">Mer</div>
                        <div class="calendar-day font-bold text-gray-600 dark:text-gray-300">Jeu</div>
                        <div class="calendar-day font-bold text-gray-600 dark:text-gray-300">Ven</div>
                        <div class="calendar-day font-bold text-gray-600 dark:text-gray-300">Sam</div>
                        <div class="calendar-day font-bold text-gray-600 dark:text-gray-300">Dim</div>
                        <!-- Jours du mois -->
                        <div class="calendar-day"></div>
                        <div class="calendar-day"></div>
                        <div class="calendar-day">1</div>
                        <div class="calendar-day">2</div>
                        <div class="calendar-day">3</div>
                        <div class="calendar-day">4</div>
                        <div class="calendar-day">5</div>
                        <div class="calendar-day">6</div>
                        <div class="calendar-day">7</div>
                        <div class="calendar-day">8</div>
                        <div class="calendar-day absent" title="Pierre Leroux - RTT">9</div>
                        <div class="calendar-day">10</div>
                        <div class="calendar-day">11</div>
                        <div class="calendar-day absent" title="Marie Dupont - Maladie">12</div>
                        <div class="calendar-day">13</div>
                        <div class="calendar-day">14</div>
                        <div class="calendar-day today">15</div>
                        <div class="calendar-day">16</div>
                        <div class="calendar-day">17</div>
                        <div class="calendar-day absent" title="Jean Martin - Congé payé">18</div>
                        <div class="calendar-day absent" title="Jean Martin - Congé payé">19</div>
                        <div class="calendar-day absent" title="Jean Martin - Congé payé">20</div>
                        <div class="calendar-day">21</div>
                        <div class="calendar-day absent" title="Marie Dupont - Congé payé">22</div>
                        <div class="calendar-day">23</div>
                        <div class="calendar-day">24</div>
                        <div class="calendar-day">25</div>
                        <div class="calendar-day">26</div>
                        <div class="calendar-day">27</div>
                        <div class="calendar-day">28</div>
                        <div class="calendar-day">29</div>
                        <div class="calendar-day">30</div>
                    </div>
                    <div class="mt-4 flex justify-between text-xs">
                        <div class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-red-500/20 rounded-full"></div>
                            <span>Absent</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                            <span>Aujourd'hui</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg border-t border-gray-200/50 dark:border-gray-700/50 p-6 mt-8">
                <div class="max-w-7xl mx-auto">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                        <div class="col-span-1 md:col-span-2">
                            <div class="flex items-center space-x-4 mb-4">
                                <div class="w-12 h-12 rounded-xl flex items-center justify-center shadow-lg">
                                    <img src="assets/images/logo.png" alt="Logo Graxel Tech" class="w-full h-full object-contain rounded-xl" />
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-gray-900 dark:text-white">Graxel Tech</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Gestion des congés pour les responsables</p>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white mb-4">Liens rapides</h4>
                            <ul class="space-y-2 text-sm">
                                <li><a href="tableau-de-bord.html" class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Tableau de bord</a></li>
                                <li><a href="demandes-equipe.html" class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Demandes d'équipe</a></li>
                                <li><a href="calendrier-equipe.html" class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Calendrier équipe</a></li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900 dark:text-white mb-4">Support</h4>
                            <ul class="space-y-2 text-sm">
                                <li><a href="#" class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Centre d'aide</a></li>
                                <li><a href="#" class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Contact RH</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="border-t border-gray-200 dark:border-gray-700 mt-8 pt-6">
                        <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                            <p class="text-sm text-gray-600 dark:text-gray-400">
                                © 2025 Graxel Tech. Tous droits réservés.
                            </p>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Modals -->
    <!-- Modal pour valider/refuser une demande -->
    <div id="decision-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white" id="modal-title">Valider la demande</h3>
                <button id="close-modal" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="decision-form">
                <input type="hidden" id="demand-id">
                <input type="hidden" id="decision-type">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Employé</label>
                    <p class="px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg" id="modal-employee">Jean Martin</p>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Type de congé</label>
                    <p class="px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg" id="modal-type">Congés payés</p>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Période</label>
                    <p class="px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg" id="modal-dates">15/09/2025 - 20/09/2025</p>
                </div>
                <div class="mb-4">
                    <label for="decision-comment" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Commentaire (optionnel)</label>
                    <textarea id="decision-comment" rows="3" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white"></textarea>
                </div>
                <div class="flex justify-end space-x-4 mt-6">
                    <button type="button" id="cancel-decision" class="px-6 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                        Annuler
                    </button>
                    <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        Confirmer
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal pour afficher les détails d'une demande -->
    <div id="details-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-900 dark:text-white">Détails de la demande</h3>
                <button id="close-details-modal" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Employé</p>
                    <p class="text-lg font-semibold text-gray-900 dark:text-white" id="details-employee">Jean Martin</p>
                </div>
                <div>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Type de congé</p>
                    <p class="text-lg font-semibold text-gray-900 dark:text-white" id="details-type">Congés payés</p>
                </div>
                <div>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Période</p>
                    <p class="text-lg font-semibold text-gray-900 dark:text-white" id="details-dates">15/09/2025 - 20/09/2025</p>
                </div>
                <div>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Statut</p>
                    <p class="text-lg font-semibold text-gray-900 dark:text-white" id="details-status">En attente</p>
                </div>
                <div>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Commentaire de l'employé</p>
                    <p class="text-gray-700 dark:text-gray-300" id="details-comment">Besoin de repos après le projet X.</p>
                </div>
                <div id="decision-history-section" class="mt-4">
                    <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Historique des décisions</h4>
                    <div id="decision-history" class="space-y-2">
                        <!-- Les décisions seront ajoutées dynamiquement -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Données statiques pour la démonstration
        const demandsData = [
            {
                id: 1,
                employee: "Jean Martin",
                type: "Congés payés",
                startDate: "2025-09-15",
                endDate: "2025-09-20",
                status: "pending",
                comment: "Besoin de repos après le projet X.",
                decisions: []
            },
            {
                id: 2,
                employee: "Marie Dupont",
                type: "Maladie",
                startDate: "2025-09-10",
                endDate: "2025-09-12",
                status: "approved",
                comment: "Certificat médical joint.",
                decisions: [
                    { date: "2025-09-09", action: "approved", comment: "Certificat validé.", by: "Jean Martin" }
                ]
            },
            {
                id: 3,
                employee: "Pierre Leroux",
                type: "RTT",
                startDate: "2025-09-08",
                endDate: "2025-09-08",
                status: "rejected",
                comment: "Demande de RTT pour équilibrer mon temps de travail.",
                decisions: [
                    { date: "2025-09-07", action: "rejected", comment: "Période critique pour le projet Y.", by: "Jean Martin" }
                ]
            },
            {
                id: 4,
                employee: "Sophie Moreau",
                type: "Exceptionnel",
                startDate: "2025-09-22",
                endDate: "2025-09-24",
                status: "pending",
                comment: "Mariage de ma sœur.",
                decisions: []
            }
        ];

        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            // Appel à votre config.js pour la gestion du thème et de la date
            // (Le thème est géré par config.js, pas besoin de logique supplémentaire ici)

            // Affichage de la date du jour
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = now.toLocaleDateString('fr-FR', options);

            // Chargement des demandes dans le tableau
            renderDemandsTable(demandsData);

            // Gestion des filtres
            document.getElementById('search-input').addEventListener('input', filterDemands);
            document.getElementById('status-filter').addEventListener('change', filterDemands);
            document.getElementById('type-filter').addEventListener('change', filterDemands);
            document.getElementById('employee-filter').addEventListener('change', filterDemands);
            document.getElementById('period-filter').addEventListener('change', toggleCustomDateRange);
            document.getElementById('start-date').addEventListener('change', filterDemands);
            document.getElementById('end-date').addEventListener('change', filterDemands);
            document.getElementById('reset-filters').addEventListener('click', resetFilters);

            // Gestion des modals
            document.getElementById('close-modal').addEventListener('click', closeModal);
            document.getElementById('cancel-decision').addEventListener('click', closeModal);
            document.getElementById('close-details-modal').addEventListener('click', closeModal);
            document.getElementById('decision-form').addEventListener('submit', handleDecision);
            document.getElementById('export-pdf').addEventListener('click', exportTableToPDF);

            // Gestion du calendrier
            document.querySelectorAll('.calendar-day:not(.font-bold)').forEach(day => {
                day.addEventListener('click', function() {
                    document.querySelectorAll('.calendar-day').forEach(d => d.classList.remove('selected'));
                    this.classList.add('selected');
                    const dayNumber = this.textContent;
                    if (dayNumber) {
                        const selectedDate = new Date(2025, 8, dayNumber); // Septembre = mois 8 (0-indexed)
                        filterDemandsByDate(selectedDate);
                    }
                });
            });

            // Sidebar toggle (conservé de votre code existant)
            document.getElementById('toggle-sidebar').addEventListener('click', function() {
                document.getElementById('sidebar').classList.remove('-translate-x-full');
                document.getElementById('sidebar-overlay').classList.remove('hidden');
            });
            document.getElementById('close-sidebar').addEventListener('click', function() {
                document.getElementById('sidebar').classList.add('-translate-x-full');
                document.getElementById('sidebar-overlay').classList.add('hidden');
            });
        });

        // Fonction pour afficher les demandes dans le tableau
        function renderDemandsTable(demands) {
            const tableBody = document.getElementById('demands-table-body');
            tableBody.innerHTML = '';

            demands.forEach(demand => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${demand.employee}</td>
                    <td>${demand.type}</td>
                    <td>${formatDate(demand.startDate)} - ${formatDate(demand.endDate)}</td>
                    <td><span class="status-badge status-${demand.status}">${capitalizeStatus(demand.status)}</span></td>
                    <td>${demand.comment}</td>
                    <td>
                        <div class="flex space-x-2">
                            ${demand.status === 'pending' ? `
                                <button class="approve-btn text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300" data-id="${demand.id}">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="reject-btn text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300" data-id="${demand.id}">
                                    <i class="fas fa-times"></i>
                                </button>
                            ` : ''}
                            <button class="view-btn text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300" data-id="${demand.id}">
                                <i class="fas fa-eye"></i>
                            </button>
                            ${demand.status === 'approved' ? `
                                <button class="pdf-btn text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300" data-id="${demand.id}">
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                            ` : ''}
                        </div>
                    </td>
                `;
                tableBody.appendChild(row);
            });

            // Réattacher les événements aux nouveaux boutons
            document.querySelectorAll('.approve-btn').forEach(btn => {
                btn.addEventListener('click', () => openDecisionModal(btn.dataset.id, 'approve'));
            });
            document.querySelectorAll('.reject-btn').forEach(btn => {
                btn.addEventListener('click', () => openDecisionModal(btn.dataset.id, 'reject'));
            });
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', () => openDetailsModal(btn.dataset.id));
            });
            document.querySelectorAll('.pdf-btn').forEach(btn => {
                btn.addEventListener('click', () => generatePDF(btn.dataset.id));
            });
        }

        // Fonction pour filtrer les demandes
        function filterDemands() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const statusFilter = document.getElementById('status-filter').value;
            const typeFilter = document.getElementById('type-filter').value;
            const employeeFilter = document.getElementById('employee-filter').value;

            let filteredDemands = demandsData.filter(demand => {
                const matchesSearch = demand.employee.toLowerCase().includes(searchTerm) ||
                                     demand.comment.toLowerCase().includes(searchTerm);

                const matchesStatus = statusFilter === 'all' || demand.status === statusFilter;

                const matchesType = typeFilter === 'all' ||
                                   (demand.type.toLowerCase() === 'congés payés' && typeFilter === 'annual') ||
                                   (demand.type.toLowerCase() === 'maladie' && typeFilter === 'sick') ||
                                   (demand.type.toLowerCase() === 'rtt' && typeFilter === 'rtt') ||
                                   (demand.type.toLowerCase() === 'exceptionnel' && typeFilter === 'exceptional') ||
                                   (demand.type.toLowerCase() === 'maternité' && typeFilter === 'maternity');

                const matchesEmployee = employeeFilter === 'all' || demand.employee === employeeFilter;

                return matchesSearch && matchesStatus && matchesType && matchesEmployee;
            });

            renderDemandsTable(filteredDemands);
            updateStats(filteredDemands);
        }

        // Fonction pour filtrer par date (calendrier)
        function filterDemandsByDate(selectedDate) {
            const day = selectedDate.getDate();
            const month = selectedDate.getMonth() + 1; // Janvier = 0
            const year = selectedDate.getFullYear();
            const formattedDate = `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;

            const filteredDemands = demandsData.filter(demand => {
                const startDate = new Date(demand.startDate);
                const endDate = new Date(demand.endDate);
                return selectedDate >= startDate && selectedDate <= endDate;
            });

            renderDemandsTable(filteredDemands);
            updateStats(filteredDemands);
        }

        // Fonction pour afficher/masquer le sélecteur de dates personnalisées
        function toggleCustomDateRange() {
            const periodFilter = document.getElementById('period-filter').value;
            const customDateRange = document.getElementById('custom-date-range');
            if (periodFilter === 'custom') {
                customDateRange.classList.remove('hidden');
            } else {
                customDateRange.classList.add('hidden');
            }
            filterDemands();
        }

        // Fonction pour réinitialiser les filtres
        function resetFilters() {
            document.getElementById('search-input').value = '';
            document.getElementById('status-filter').value = 'all';
            document.getElementById('type-filter').value = 'all';
            document.getElementById('employee-filter').value = 'all';
            document.getElementById('period-filter').value = 'month';
            document.getElementById('custom-date-range').classList.add('hidden');
            renderDemandsTable(demandsData);
            updateStats(demandsData);
        }

        // Fonction pour mettre à jour les statistiques
        function updateStats(demands) {
            const pendingCount = demands.filter(d => d.status === 'pending').length;
            const approvedCount = demands.filter(d => d.status === 'approved').length;

            document.getElementById('pending-count').textContent = pendingCount;
            document.getElementById('approved-count').textContent = approvedCount;

            // Trouver l'employé le plus absent
            const employeeAbsences = {};
            demands.forEach(demand => {
                if (demand.status === 'approved') {
                    const days = calculateDays(demand.startDate, demand.endDate);
                    if (!employeeAbsences[demand.employee]) {
                        employeeAbsences[demand.employee] = 0;
                    }
                    employeeAbsences[demand.employee] += days;
                }
            });

            let topEmployee = "Aucun";
            let topDays = 0;
            for (const [employee, days] of Object.entries(employeeAbsences)) {
                if (days > topDays) {
                    topEmployee = employee;
                    topDays = days;
                }
            }

            document.getElementById('top-absent-employee').textContent = topEmployee;
            document.getElementById('top-absent-days').textContent = `${topDays} jours`;
        }

        // Fonction pour calculer le nombre de jours entre deux dates
        function calculateDays(startDate, endDate) {
            const start = new Date(startDate);
            const end = new Date(endDate);
            const timeDiff = end.getTime() - start.getTime();
            return Math.ceil(timeDiff / (1000 * 3600 * 24)) + 1; // +1 pour inclure le jour de fin
        }

        // Fonction pour formater une date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('fr-FR');
        }

        // Fonction pour capitaliser le statut
        function capitalizeStatus(status) {
            const statusMap = {
                'pending': 'En attente',
                'approved': 'Validé',
                'rejected': 'Refusé'
            };
            return statusMap[status] || status;
        }

        // Fonction pour ouvrir le modal de décision
        function openDecisionModal(demandId, decisionType) {
            const demand = demandsData.find(d => d.id == demandId);
            if (!demand) return;

            const modal = document.getElementById('decision-modal');
            const title = document.getElementById('modal-title');
            const employee = document.getElementById('modal-employee');
            const type = document.getElementById('modal-type');
            const dates = document.getElementById('modal-dates');
            const form = document.getElementById('decision-form');

            title.textContent = decisionType === 'approve' ? 'Valider la demande' : 'Refuser la demande';
            employee.textContent = demand.employee;
            type.textContent = demand.type;
            dates.textContent = `${formatDate(demand.startDate)} - ${formatDate(demand.endDate)}`;

            document.getElementById('demand-id').value = demandId;
            document.getElementById('decision-type').value = decisionType;
            document.getElementById('decision-comment').value = '';

            modal.classList.remove('hidden');
        }

        // Fonction pour ouvrir le modal de détails
        function openDetailsModal(demandId) {
            const demand = demandsData.find(d => d.id == demandId);
            if (!demand) return;

            const modal = document.getElementById('details-modal');
            document.getElementById('details-employee').textContent = demand.employee;
            document.getElementById('details-type').textContent = demand.type;
            document.getElementById('details-dates').textContent = `${formatDate(demand.startDate)} - ${formatDate(demand.endDate)}`;
            document.getElementById('details-status').textContent = capitalizeStatus(demand.status);
            document.getElementById('details-comment').textContent = demand.comment || 'Aucun commentaire';

            const historyContainer = document.getElementById('decision-history');
            historyContainer.innerHTML = '';

            if (demand.decisions.length > 0) {
                demand.decisions.forEach(decision => {
                    const decisionElement = document.createElement('div');
                    decisionElement.className = 'p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg';
                    decisionElement.innerHTML = `
                        <p class="text-sm font-medium ${decision.action === 'approved' ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}">
                            ${capitalizeStatus(decision.action)} le ${formatDate(decision.date)} par ${decision.by}
                        </p>
                        ${decision.comment ? `<p class="text-xs text-gray-600 dark:text-gray-300 mt-1">${decision.comment}</p>` : ''}
                    `;
                    historyContainer.appendChild(decisionElement);
                });
            } else {
                historyContainer.innerHTML = '<p class="text-sm text-gray-500 dark:text-gray-400">Aucune décision enregistrée.</p>';
            }

            modal.classList.remove('hidden');
        }

        // Fonction pour fermer les modals
        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.add('hidden');
            });
        }

        // Fonction pour gérer la validation/refus d'une demande
        function handleDecision(e) {
            e.preventDefault();
            const demandId = document.getElementById('demand-id').value;
            const decisionType = document.getElementById('decision-type').value;
            const comment = document.getElementById('decision-comment').value;

            const demandIndex = demandsData.findIndex(d => d.id == demandId);
            if (demandIndex === -1) return;

            // Mise à jour du statut
            demandsData[demandIndex].status = decisionType;

            // Ajout de la décision à l'historique
            const now = new Date();
            demandsData[demandIndex].decisions.push({
                date: now.toISOString().split('T')[0],
                action: decisionType,
                comment: comment,
                by: "Jean Martin" // À remplacer par le nom du chef connecté
            });

            // Fermeture du modal et rafraîchissement
            closeModal();
            renderDemandsTable(demandsData);
            updateStats(demandsData);

            // Notification de succès
            const notyf = new Notyf();
            notyf.success(`Demande ${decisionType === 'approve' ? 'validée' : 'refusée'} avec succès !`);
        }

        // Fonction pour générer une attestation PDF
        function generatePDF(demandId) {
            const demand = demandsData.find(d => d.id == demandId);
            if (!demand) return;

            // Création du document PDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Contenu du PDF
            doc.setFontSize(18);
            doc.text("ATTESTATION DE CONGÉ", 105, 20, { align: 'center' });
            doc.setFontSize(12);
            doc.text(`Je soussigné(e), Jean Martin, Chef du Département Finance,`, 20, 40);
            doc.text(`atteste que ${demand.employee} a bénéficié d'un congé de type`, 20, 50);
            doc.text(`"${demand.type}" du ${formatDate(demand.startDate)} au ${formatDate(demand.endDate)}.`, 20, 60);
            doc.text(`Fait à Libreville, le ${new Date().toLocaleDateString('fr-FR')}.`, 20, 80);
            doc.text(`Signature : _____________________`, 20, 100);

            // Téléchargement du PDF
            doc.save(`attestation_conge_${demand.employee.replace(' ', '_')}.pdf`);
        }

        // Fonction pour exporter le tableau en PDF
        function exportTableToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('l', 'mm', 'a4');

            // Titre
            doc.setFontSize(16);
            doc.text("LISTE DES DEMANDES D'ÉQUIPE", 140, 20, { align: 'center' });
            doc.setFontSize(10);
            doc.text(`Généré le ${new Date().toLocaleDateString('fr-FR')}`, 20, 30);

            // Conversion du tableau en image
            html2canvas(document.querySelector('.demand-table')).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 270;
                const pageHeight = doc.internal.pageSize.height;
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 40;

                doc.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    doc.addPage();
                    doc.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                doc.save('demandes_equipe.pdf');
            });
        }
    </script>
</body>
</html>
